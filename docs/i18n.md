# Internationalization (i18n) Implementation Guide

This guide explains how to implement internationalization in the Agent App with support for English (en), Hungarian (hu), and German (de).

## Overview

The i18n solution uses:
- **Frontend**: `vue-i18n` for Vue.js components
- **Backend**: `i18n` package for Node.js/Express
- **Translation Files**: JSON files organized by language in separate directories

## Directory Structure

```
backend/
‚îú‚îÄ‚îÄ locales/
‚îÇ   ‚îú‚îÄ‚îÄ en/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errors.json
‚îÇ   ‚îú‚îÄ‚îÄ hu/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errors.json
‚îÇ   ‚îî‚îÄ‚îÄ de/
‚îÇ       ‚îú‚îÄ‚îÄ common.json
‚îÇ       ‚îú‚îÄ‚îÄ auth.json
‚îÇ       ‚îú‚îÄ‚îÄ users.json
‚îÇ       ‚îî‚îÄ‚îÄ errors.json

frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ locales/
‚îÇ       ‚îú‚îÄ‚îÄ en/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ common.json
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth.json
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ users.json
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ admin.json
‚îÇ       ‚îú‚îÄ‚îÄ hu/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ common.json
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth.json
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ users.json
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ admin.json
‚îÇ       ‚îî‚îÄ‚îÄ de/
‚îÇ           ‚îú‚îÄ‚îÄ common.json
‚îÇ           ‚îú‚îÄ‚îÄ auth.json
‚îÇ           ‚îú‚îÄ‚îÄ users.json
‚îÇ           ‚îî‚îÄ‚îÄ admin.json
```

---

## Backend Implementation

### 1. Install Dependencies

```bash
cd backend
npm install i18n
```

### 2. Configure i18n

Create `backend/src/config/i18n.js`:

```javascript
const i18n = require('i18n');
const path = require('path');

i18n.configure({
  locales: ['en', 'hu', 'de'],
  defaultLocale: 'en',
  directory: path.join(__dirname, '../../locales'),
  objectNotation: true,
  updateFiles: false,
  syncFiles: false,
  api: {
    __: 't',
    __n: 'tn'
  }
});

module.exports = i18n;
```

### 3. Add Middleware

In `backend/src/app.js`:

```javascript
const i18n = require('./config/i18n');

// Add before routes
app.use(i18n.init);

// Middleware to set locale from header or query
app.use((req, res, next) => {
  const locale = req.headers['accept-language']?.split(',')[0]?.split('-')[0] || 
                 req.query.lang || 
                 'en';
  
  if (['en', 'hu', 'de'].includes(locale)) {
    req.setLocale(locale);
  }
  next();
});
```

### 4. Create Translation Files

**backend/locales/en/common.json**:
```json
{
  "welcome": "Welcome",
  "success": "Success",
  "error": "Error"
}
```

**backend/locales/en/auth.json**:
```json
{
  "login": {
    "success": "Login successful",
    "failed": "Invalid credentials",
    "required": "Email and password are required"
  },
  "logout": {
    "success": "Logged out successfully"
  }
}
```

**backend/locales/en/errors.json**:
```json
{
  "notFound": "Resource not found",
  "unauthorized": "Unauthorized access",
  "forbidden": "Access forbidden",
  "serverError": "Internal server error"
}
```

**backend/locales/hu/common.json**:
```json
{
  "welcome": "√údv√∂z√∂lj√ºk",
  "success": "Sikeres",
  "error": "Hiba"
}
```

**backend/locales/de/common.json**:
```json
{
  "welcome": "Willkommen",
  "success": "Erfolgreich",
  "error": "Fehler"
}
```

### 5. Use in Controllers

```javascript
// In any controller
async login(req, res) {
  try {
    const result = await authService.login(email, password);
    res.json({ 
      message: req.t('auth.login.success'),
      ...result 
    });
  } catch (error) {
    res.status(401).json({ 
      message: req.t('auth.login.failed') 
    });
  }
}
```

---

## Frontend Implementation

### 1. Install Dependencies

```bash
cd frontend
npm install vue-i18n@9
```

### 2. Configure i18n

Create `frontend/src/i18n/index.js`:

```javascript
import { createI18n } from 'vue-i18n';

// Import all translation files
import enCommon from '../locales/en/common.json';
import enAuth from '../locales/en/auth.json';
import enUsers from '../locales/en/users.json';
import enAdmin from '../locales/en/admin.json';

import huCommon from '../locales/hu/common.json';
import huAuth from '../locales/hu/auth.json';
import huUsers from '../locales/hu/users.json';
import huAdmin from '../locales/hu/admin.json';

import deCommon from '../locales/de/common.json';
import deAuth from '../locales/de/auth.json';
import deUsers from '../locales/de/users.json';
import deAdmin from '../locales/de/admin.json';

const messages = {
  en: {
    common: enCommon,
    auth: enAuth,
    users: enUsers,
    admin: enAdmin
  },
  hu: {
    common: huCommon,
    auth: huAuth,
    users: huUsers,
    admin: huAdmin
  },
  de: {
    common: deCommon,
    auth: deAuth,
    users: deUsers,
    admin: deAdmin
  }
};

const i18n = createI18n({
  legacy: false,
  locale: localStorage.getItem('locale') || 'en',
  fallbackLocale: 'en',
  messages
});

export default i18n;
```

### 3. Register in App

In `frontend/src/main.js`:

```javascript
import { createApp } from 'vue';
import App from './App.vue';
import router from './router';
import { createPinia } from 'pinia';
import i18n from './i18n';

const app = createApp(App);

app.use(createPinia());
app.use(router);
app.use(i18n);
app.mount('#app');
```

### 4. Create Translation Files

**frontend/src/locales/en/common.json**:
```json
{
  "app": {
    "title": "Agent App",
    "home": "Home",
    "users": "Users",
    "roles": "Roles",
    "groups": "Groups",
    "permissions": "Permissions"
  },
  "actions": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "create": "Create",
    "search": "Search"
  }
}
```

**frontend/src/locales/en/auth.json**:
```json
{
  "login": {
    "title": "Login",
    "email": "Email",
    "password": "Password",
    "submit": "Login",
    "success": "Login successful",
    "error": "Invalid credentials"
  },
  "logout": "Logout"
}
```

**frontend/src/locales/hu/common.json**:
```json
{
  "app": {
    "title": "√úgyn√∂k Alkalmaz√°s",
    "home": "Kezd≈ëlap",
    "users": "Felhaszn√°l√≥k",
    "roles": "Szerepk√∂r√∂k",
    "groups": "Csoportok",
    "permissions": "Jogosults√°gok"
  },
  "actions": {
    "save": "Ment√©s",
    "cancel": "M√©gse",
    "delete": "T√∂rl√©s",
    "edit": "Szerkeszt√©s",
    "create": "L√©trehoz√°s",
    "search": "Keres√©s"
  }
}
```

**frontend/src/locales/de/common.json**:
```json
{
  "app": {
    "title": "Agent-App",
    "home": "Startseite",
    "users": "Benutzer",
    "roles": "Rollen",
    "groups": "Gruppen",
    "permissions": "Berechtigungen"
  },
  "actions": {
    "save": "Speichern",
    "cancel": "Abbrechen",
    "delete": "L√∂schen",
    "edit": "Bearbeiten",
    "create": "Erstellen",
    "search": "Suchen"
  }
}
```

### 5. Use in Components

**Composition API**:
```vue
<script setup>
import { useI18n } from 'vue-i18n';

const { t, locale } = useI18n();

const changeLanguage = (lang) => {
  locale.value = lang;
  localStorage.setItem('locale', lang);
};
</script>

<template>
  <div>
    <h1>{{ t('common.app.title') }}</h1>
    <button @click="changeLanguage('en')">English</button>
    <button @click="changeLanguage('hu')">Magyar</button>
    <button @click="changeLanguage('de')">Deutsch</button>
  </div>
</template>
```

**In Templates**:
```vue
<template>
  <div>
    <h2>{{ $t('users.title') }}</h2>
    <button>{{ $t('common.actions.create') }}</button>
    <p>{{ $t('users.count', { count: users.length }) }}</p>
  </div>
</template>
```

---

## Language Switcher Component

Create `frontend/src/components/LanguageSwitcher.vue`:

```vue
<script setup>
import { useI18n } from 'vue-i18n';

const { locale } = useI18n();

const languages = [
  { code: 'en', name: 'English', flag: 'üá¨üáß' },
  { code: 'hu', name: 'Magyar', flag: 'üá≠üá∫' },
  { code: 'de', name: 'Deutsch', flag: 'üá©üá™' }
];

const changeLanguage = (lang) => {
  locale.value = lang;
  localStorage.setItem('locale', lang);
};
</script>

<template>
  <div class="flex gap-2">
    <button
      v-for="lang in languages"
      :key="lang.code"
      @click="changeLanguage(lang.code)"
      :class="[
        'px-3 py-1 text-xs font-bold rounded transition-colors',
        locale === lang.code
          ? 'bg-neon-blue text-white'
          : 'text-gray-400 hover:text-white'
      ]"
    >
      {{ lang.flag }} {{ lang.name }}
    </button>
  </div>
</template>
```

---

## Best Practices

### 1. Namespace Organization
- Use nested keys for better organization
- Group related translations together
- Use consistent naming conventions

### 2. Pluralization
```json
{
  "items": "no items | one item | {count} items"
}
```

```vue
{{ $t('items', { count: 5 }) }}
```

### 3. Interpolation
```json
{
  "welcome": "Welcome, {name}!"
}
```

```vue
{{ $t('welcome', { name: user.name }) }}
```

### 4. Date/Number Formatting
```javascript
import { useI18n } from 'vue-i18n';

const { n, d } = useI18n();

// Number formatting
n(1234.56, 'currency') // $1,234.56 (en), 1 234,56 Ft (hu)

// Date formatting
d(new Date(), 'short') // 12/6/2025 (en), 2025.12.06. (hu)
```

---

## API Integration

### Send Language Header

```javascript
// In axios interceptor
axios.interceptors.request.use((config) => {
  const locale = localStorage.getItem('locale') || 'en';
  config.headers['Accept-Language'] = locale;
  return config;
});
```

### Backend Response

```javascript
// Controller
res.json({
  message: req.t('success.message'),
  data: result
});
```

---

## Testing Translations

### 1. Check Missing Keys
```bash
# Install i18n-check
npm install -g i18n-check

# Check for missing translations
i18n-check frontend/src/locales
```

### 2. Validate JSON Files
```bash
# Use jsonlint
npm install -g jsonlint

jsonlint frontend/src/locales/en/common.json
```

---

## Migration Strategy

1. **Identify all hardcoded strings** in components and controllers
2. **Create translation keys** in JSON files
3. **Replace strings** with `$t()` calls (frontend) or `req.t()` (backend)
4. **Test each language** thoroughly
5. **Add language switcher** to UI

---

## Useful Resources

- [Vue I18n Documentation](https://vue-i18n.intlify.dev/)
- [i18n Node.js Documentation](https://github.com/mashpie/i18n-node)
- [ICU Message Format](https://unicode-org.github.io/icu/userguide/format_parse/messages/)
